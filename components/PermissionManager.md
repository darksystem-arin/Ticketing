
# مستندات کامپوننت `PermissionManager.tsx`

این کامپوننت یک پنل مدیریتی کامل است که به کاربر ادمین اجازه می‌دهد تا کاربران، واحدهای کاری و سطوح دسترسی آن‌ها را مدیریت کند. این صفحه قلب تپنده مدیریت سیستم است.

## وظایف اصلی

### ۱. مدیریت واحدهای کاری (Departments)

این بخش به دو قسمت مجزا برای مدیریت بهتر تقسیم شده است:

*   **واحدهای پشتیبانی (Support Units)**: این‌ها دپارتمان‌های داخلی سازمان شما هستند که مسئول پاسخگویی به تیکت‌ها می‌باشند (مانند پشتیبانی فنی، فروش و...). کارشناسان سیستم به این واحدها تخصیص داده می‌شوند.
*   **واحدهای مشتری (Customer Units)**: این‌ها برای دسته‌بندی مشتریان یا سازمان‌های طرف قرارداد شما استفاده می‌شوند. این قابلیت به شما اجازه می‌دهد تا ساختار مشتریان خود را در سیستم تعریف کنید.

**امکانات:**

*   **ایجاد واحد جدید**: یک فرم برای تعریف نام واحد جدید و **انتخاب نوع آن** (پشتیبانی یا مشتری) فراهم می‌کند.
*   **نمایش و حذف واحدها**: لیست تمام واحدهای تعریف‌شده را به تفکیک نوع نمایش می‌دهد و به ادمین اجازه می‌دهد تا واحدهای کاری موجود را حذف کند.

### ۲. مدیریت کاربران

*   **افزودن کاربر جدید**: یک فرم کامل برای ایجاد کاربر جدید ارائه می‌دهد که شامل فیلدهای زیر است:
    *   **نام کاربری**، **نام نمایشی** و **رمز عبور**.
    *   **نقش کاربر**: می‌توانید انتخاب کنید که کاربر جدید یک **«کارشناس»** (عضو تیم پشتیبانی) باشد یا یک **«کاربر»** (مشتری).
    *   **تخصیص واحد**: بر اساس نقش انتخاب شده، منوی کشویی به صورت هوشمند لیست واحدهای مربوطه (پشتیبانی یا مشتری) را نمایش می‌دهد.
*   **نمایش لیست کاربران**: تمام کاربران سیستم را در یک جدول نمایش می‌دهد. در این جدول **نقش هر کاربر** (ادمین، کارشناس، کاربر) با یک نشانگر رنگی مشخص شده است.
*   **ویرایش اطلاعات کاربر**:
    *   امکان ویرایش مستقیم **نام نمایشی** و **شماره تماس** کاربر در جدول وجود دارد.
    *   یک منوی کشویی برای **تخصیص کاربر به واحد** فراهم شده است. این منو بر اساس نقش کاربر، لیست واحدهای مربوطه (پشتیبانی یا مشتری) را نمایش می‌دهد.
*   **مدیریت دسترسی‌ها (Permissions)**:
    *   برای هر کاربر، چهار دکمه Toggle برای کنترل دسترسی‌های زیر وجود دارد:
        *   `مشاهده`: آیا کاربر می‌تواند تیکت‌ها را ببیند؟
        *   `پاسخ`: آیا کاربر می‌تواند به تیکت‌ها پاسخ دهد؟
        *   `ایجاد`: آیا کاربر می‌تواند تیکت جدید ایجاد کند؟
        *   `ادمین`: آیا کاربر به پنل‌های مدیریتی (داشبورد و همین صفحه) دسترسی دارد؟
*   **حذف کاربر**: امکان حذف کامل یک کاربر از سیستم را فراهم می‌کند.

## Props (ورودی‌ها)

| نام Prop         | نوع                                                              | توضیحات                                                                                                  |
| :--------------- | :--------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------- |
| `users`          | `ManagedUser[]`                                                  | آرایه‌ای از تمام کاربران مدیریتی سیستم.                                                                  |
| `units`          | `Unit[]`                                                         | آرایه‌ای از تمام واحدهای کاری سیستم.                                                                      |
| `onUpdateUser`   | `(user: ManagedUser) => void`                                    | تابعی که هنگام تغییر هر یک از اطلاعات یا دسترسی‌های یک کاربر فراخوانی می‌شود.                            |
| `onAddUser`      | `(username: string, password: string, name: string, role: UserRole, unitId?: string) => void` | تابعی که پس از ارسال فرم افزودن کاربر جدید، برای ایجاد آن در سیستم فراخوانی می‌شود.                      |
| `onDeleteUser`   | `(username: string) => void`                                     | تابعی که برای حذف یک کاربر با نام کاربری مشخص فراخوانی می‌شود.                                            |
| `onAddUnit`      | `(name: string, type: UnitType) => void`                         | تابعی که برای افزودن یک واحد کاری جدید با نام و نوع مشخص فراخوانی می‌شود.                                |
| `onDeleteUnit`   | `(id: string) => void`                                           | تابعی که برای حذف یک واحد کاری با شناسه مشخص فراخوانی می‌شود.                                            |